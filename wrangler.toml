name = "nautilus"
compatibility_date = "2024-10-01"

kv_namespaces = [
  { binding = "NAUTILUS_DATA", id = "f273064ffa244b1c9bd696e915ed9197", preview_id = "f273064ffa244b1c9bd696e915ed9197" },
  { binding = "NAUTILUS_FILES", id = "9564a9073c8c482c82b60aece721ba79", preview_id = "c85af804006e4b9e8c9b60d5d31a5af2" },
  { binding = "FEEDBACK_SCREENSHOTS", id = "2b081a6d880c4e3f97fbbcfea6ecef31", preview_id = "2b081a6d880c4e3f97fbbcfea6ecef31" }
]

[vars]
# Base URL used in notification emails (CTA links).
# NOTE: APP_BASE_URL is now auto-detected from the request origin.
# Local dev: http://localhost:8787
# Production: https://nautilus-dky.pages.dev
# You can override by setting APP_BASE_URL environment variable if needed.
# Default recipient + sender for Resend-powered alerts (override via secrets for production).
NOTIFICATION_RECIPIENT = "franciscovillanu@gmail.com"
RESEND_FROM="Nautilus Notifications <onboarding@resend.dev>"
# Tenerife time zone reference for the notification window.
NOTIFICATION_TIMEZONE = "Atlantic/Canary"

# NOTE: Configure `RESEND_API_KEY`, `NOTIFICATION_TOKEN`, etc. as Wrangler secrets:
# wrangler secret put RESEND_API_KEY
# wrangler secret put NOTIFICATION_TOKEN
# wrangler secret put JWT_SECRET
# wrangler secret put ADMIN_PIN
#
# Optional (recommended for zero-downtime JWT rotation):
# - Set `JWT_SECRET` to a new random secret (used for signing new tokens)
# - Set `JWT_SECRET_PREVIOUS` to the prior secret for a limited time (tokens issued
#   under the old secret keep working until expiry), then remove it.

# Cron triggers for /api/notifications should be created through Cloudflare Scheduled Functions
# (or via dashboard) once deployed.

# D1 Database for Feedback
[[d1_databases]]
binding = "FEEDBACK_DB"
database_name = "nautilus-feedback"
database_id = "545c8f8e-3e90-45e0-a3f0-89399e2db957"
